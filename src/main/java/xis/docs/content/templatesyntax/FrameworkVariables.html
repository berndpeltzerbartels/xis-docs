<xis:template xmlns:xis="http://www.w3.org/1999/XSL/Transform">
    <h3>${chapterHeadline}</h3>
    <xis:raw>
    <p>
        XIS automatically provides several framework variables in the expression language. These variables give access 
        to client-side storage, URL information, and validation state. All framework variables are available in every 
        page and widget template.
    </p>

    <h5>Storage Variables</h5>
    <p>Access browser storage directly from templates:</p>

    <h6>localStorage</h6>
    <p>Persistent storage that survives browser restarts. Stored on the client-side only.</p>
    <pre><code>&lt;!-- Access localStorage values --&gt;
&lt;div&gt;Theme: ${localStorage.theme}&lt;/div&gt;
&lt;span&gt;${localStorage.userPreference}&lt;/span&gt;

&lt;!-- Use in conditions --&gt;
&lt;div xis:if="localStorage.darkMode == 'true'"&gt;Dark mode active&lt;/div&gt;</code></pre>
    <p><strong>Scope:</strong> Persists across browser sessions. Cleared only when user clears browser data.</p>

    <h6>sessionStorage</h6>
    <p>Temporary storage that exists only during the current browser session (tab).</p>
    <pre><code>&lt;!-- Access sessionStorage values --&gt;
&lt;div&gt;Current Tab: ${sessionStorage.activeTab}&lt;/div&gt;
&lt;input value="${sessionStorage.lastSearch}"/&gt;

&lt;!-- Use in comparisons --&gt;
&lt;li class="${sessionStorage.currentPage == 'home' ? 'active' : ''}"&gt;Home&lt;/li&gt;</code></pre>
    <p><strong>Scope:</strong> Persists within a single browser tab/window. Cleared when the tab is closed.</p>

    <h6>clientStorage</h6>
    <p>Server-side storage synchronized with the client. Values are stored on the server and sent to the client on each request.</p>
    <pre><code>&lt;!-- Access clientStorage values --&gt;
&lt;div&gt;User Setting: ${clientStorage.userSetting}&lt;/div&gt;
&lt;span&gt;${clientStorage.preference}&lt;/span&gt;</code></pre>
    <p><strong>Scope:</strong> Stored on the server, synchronized with client. Persists across browser restarts and different devices for the same user session.</p>

    <h5>URL Variables</h5>
    <p>Access information about the current URL:</p>

    <h6>url</h6>
    <p>The complete URL including protocol, host, path, and query parameters.</p>
    <pre><code>&lt;!-- Display full URL --&gt;
&lt;div&gt;Current URL: ${url}&lt;/div&gt;
&lt;!-- Example: "https://example.com/products?category=electronics&amp;page=2" --&gt;</code></pre>

    <h6>pathname</h6>
    <p>Only the path portion of the URL, without protocol, host, or query parameters.</p>
    <pre><code>&lt;!-- Highlight current navigation item --&gt;
&lt;a href="/products" class="${pathname == '/products' ? 'active' : ''}"&gt;Products&lt;/a&gt;
&lt;!-- Example pathname: "/products" --&gt;</code></pre>

    <h6>origin</h6>
    <p>The origin (protocol + host) of the current URL.</p>
    <pre><code>&lt;!-- Build absolute URLs --&gt;
&lt;a href="${origin}/api/export"&gt;Download&lt;/a&gt;
&lt;!-- Example origin: "https://example.com" --&gt;</code></pre>

    <h6>queryParams</h6>
    <p>An object containing all URL query parameters as key-value pairs.</p>
    <pre><code>&lt;!-- Access individual parameters --&gt;
&lt;div&gt;Category: ${queryParams.category}&lt;/div&gt;
&lt;div&gt;Page: ${queryParams.page}&lt;/div&gt;

&lt;!-- Use in conditions --&gt;
&lt;div xis:if="queryParams.debug == 'true'"&gt;Debug Info&lt;/div&gt;

&lt;!-- For URL: /products?category=electronics&amp;page=2
     queryParams.category → "electronics"
     queryParams.page → "2" --&gt;</code></pre>

    <h5>Validation Messages</h5>
    <p>
        Access validation error and warning messages. <strong>Note:</strong> You typically don't need to use this 
        directly, as XIS provides built-in mechanisms for displaying validation messages (see Forms documentation). 
        Use this only for custom validation display scenarios.
    </p>

    <h6>Structure</h6>
    <p>The <code>validation</code> variable contains:</p>
    <ul>
        <li><code>validation.globalMessages</code> - Array of global validation messages (not tied to specific fields)</li>
        <li><code>validation.messages</code> - Object mapping field names to error messages</li>
    </ul>

    <h6>Message Types</h6>
    <p>There are two CSS classes for displaying validation messages:</p>
    <ul>
        <li><code>warn</code> - Red error messages (for validation errors)</li>
        <li><code>info</code> - Yellow/blue info messages (for warnings or informational messages)</li>
    </ul>

    <h6>Example (Advanced Use)</h6>
    <pre><code>&lt;!-- Display global validation messages --&gt;
&lt;div xis:foreach="msg:validation.globalMessages"&gt;
    &lt;div class="warn"&gt;${msg}&lt;/div&gt;
&lt;/div&gt;

&lt;!-- Display field-specific error --&gt;
&lt;input name="email" value="${user.email}"/&gt;
&lt;span class="warn" xis:if="validation.messages.email"&gt;
    ${validation.messages.email}
&lt;/span&gt;

&lt;!-- Custom info message --&gt;
&lt;div class="info"&gt;Please check your input carefully.&lt;/div&gt;</code></pre>

    <div class="warning">
        <p><strong>Important:</strong> The <code>validation</code> variable is primarily for advanced custom scenarios. 
        For standard form validation, use the built-in <code>&lt;xis:message&gt;</code> tag and form validation 
        mechanisms described in the Forms chapter. These handle validation display automatically and correctly.</p>
    </div>

    <h5>Complete Example</h5>
    <pre><code>&lt;!-- Navigation with URL highlighting --&gt;
&lt;nav&gt;
    &lt;a href="/home" class="${pathname == '/home' ? 'active' : ''}"&gt;Home&lt;/a&gt;
    &lt;a href="/products" class="${pathname == '/products' ? 'active' : ''}"&gt;Products&lt;/a&gt;
&lt;/nav&gt;

&lt;!-- Display user preferences from storage --&gt;
&lt;div class="theme-${localStorage.theme}"&gt;
    &lt;h2&gt;Welcome back!&lt;/h2&gt;
    &lt;p&gt;Current tab: ${sessionStorage.activeTab}&lt;/p&gt;
&lt;/div&gt;

&lt;!-- Use query parameters --&gt;
&lt;div xis:if="queryParams.category"&gt;
    Showing category: ${queryParams.category}
&lt;/div&gt;</code></pre>

    <h5>Summary</h5>
    <ul>
        <li><code>localStorage</code>, <code>sessionStorage</code>, <code>clientStorage</code> - Access client and server-side storage</li>
        <li><code>url</code>, <code>pathname</code>, <code>origin</code> - URL information for navigation and links</li>
        <li><code>queryParams</code> - Access URL query parameters as key-value pairs</li>
        <li><code>validation</code> - Validation messages (use sparingly, prefer built-in form mechanisms)</li>
    </ul>
    </xis:raw>
</xis:template>
