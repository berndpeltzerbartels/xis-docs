<xis:template xmlns:xis="http://www.w3.org/1999/XSL/Transform">
    <h3>Widget Navigation</h3>
    <p>Widgets can navigate to other widgets or pages through various mechanisms: template links, action method 
        return values, and programmatic responses.</p>

    <h5>Widget Links in Templates</h5>
    <p>Use <code>xis:widget="WidgetClassName"</code> on links to load a widget into its container:</p>
    <pre><code class="language-html">&lt;a xis:widget="ProductDetailsWidget"&gt;View Details&lt;/a&gt;

&lt;button xis:widget="EditFormWidget"&gt;Edit Product&lt;/button&gt;</code></pre>
    <p>When clicked, the specified widget replaces the current widget in the same container.</p>

    <h5>Widget Links with Parameters</h5>
    <p>Pass parameters using query string or <code>&lt;xis:parameter&gt;</code> tags:</p>
    <pre><code class="language-html">&lt;!-- Query string style --&gt;
&lt;a xis:widget="ProductDetailsWidget?productId=${product.id}&amp;tab=reviews"&gt;
    View Details
&lt;/a&gt;

&lt;!-- Parameter tags style --&gt;
&lt;a xis:widget="ProductDetailsWidget"&gt;
    &lt;xis:parameter name="productId" value="${product.id}"/&gt;
    &lt;xis:parameter name="tab" value="reviews"/&gt;
    View Details
&lt;/a&gt;</code></pre>

    <h5>Navigation from Actions</h5>
    <p>Action methods can return different types to control navigation:</p>

    <h6>Void Return - Stay on Current Widget</h6>
    <pre><code class="language-java">@Action("refresh")
void refreshData() {
    dataService.refresh();
    // Returns void - widget stays, data reloads
}</code></pre>

    <h6>Class&lt;?&gt; Return - Navigate to Page</h6>
    <pre><code class="language-java">@Action("backToList")
Class&lt;?&gt; backToProductList() {
    return ProductListPage.class; // Navigate to different page
}</code></pre>

    <h6>WidgetResponse - Navigate to Widget</h6>
    <p><code>WidgetResponse</code> provides the most control over widget navigation:</p>
    <pre><code class="language-java">@Action("viewDetails")
WidgetResponse showDetails(@ActionParameter("productId") String productId) {
    return new WidgetResponse(ProductDetailsWidget.class)
        .addParameter("productId", productId)
        .addParameter("tab", "specifications");
}</code></pre>

    <h6>Widget ID String Return</h6>
    <p>Actions can also return a widget ID as a string. This is particularly useful for distributed applications 
        where the widget class might not be in your classpath:</p>
    <pre><code class="language-java">@Action("loadRemoteWidget")
String loadFromRemoteServer() {
    return "RemoteProductWidget"; // Widget served by another server
}</code></pre>
    <p><strong>Note:</strong> String-based widget IDs enable micro-frontend architectures. See 
        <a href="#" xis:page="DistributedApplications">Distributed Applications</a> for details.</p>

    <h5>Widget ID Concept</h5>
    <p>Every widget instance has a unique ID that identifies it. By default, the ID is the simple class name:</p>
    <pre><code class="language-java">@Widget  // ID defaults to "ProductListWidget"
class ProductListWidget {
}

@Widget(id = "customProductList")  // Custom ID
class ProductListWidget {
}</code></pre>
    <p>Widget IDs are used for:</p>
    <ul>
        <li>Navigation targets in <code>WidgetResponse</code></li>
        <li>Template widget links: <code>xis:widget="ProductListWidget"</code></li>
        <li>String-based navigation return values</li>
        <li>Remote widget loading in distributed systems</li>
    </ul>

    <h5>Target Container Navigation</h5>
    <p>By default, widgets load into their current container. Use <code>targetContainer</code> to load into a 
        different container:</p>
    <pre><code class="language-java">@Action("showInSidebar")
WidgetResponse loadIntoSidebar(@ActionParameter("itemId") String itemId) {
    return new WidgetResponse(ItemDetailsWidget.class)
        .targetContainer("sidebar")  // Load into sidebar container
        .addParameter("itemId", itemId);
}</code></pre>
    <pre><code class="language-html">&lt;!-- Page with multiple containers --&gt;
&lt;aside&gt;
    &lt;xis:widget-container container-id="sidebar" default-widget="NavigationWidget"&gt;
    &lt;/xis:widget-container&gt;
&lt;/aside&gt;
&lt;main&gt;
    &lt;xis:widget-container container-id="main" default-widget="ContentWidget"&gt;
    &lt;/xis:widget-container&gt;
&lt;/main&gt;</code></pre>

    <h5>Target Container with Widget Links</h5>
    <p>Widget links can also specify a target container using <code>xis:target-container</code>:</p>
    <pre><code class="language-html">&lt;a xis:widget="ProductDetailsWidget" xis:target-container="main"&gt;
    &lt;xis:parameter name="productId" value="${product.id}"/&gt;
    View in Main Area
&lt;/a&gt;</code></pre>

    <h5>PageResponse - Navigate to Page with Target Container</h5>
    <p>Actions can navigate to pages and specify which container to update:</p>
    <pre><code class="language-java">@Action("showCategoryPage")
PageResponse navigateToCategory(@ActionParameter("categoryId") String categoryId) {
    return new PageResponse(CategoryPage.class)
        .targetContainer("main")
        .addParameter("categoryId", categoryId);
}</code></pre>
    <p><strong>Note on Response Types:</strong> <code>WidgetResponse</code> and <code>PageResponse</code> indicate 
        <em>what type of component will be loaded</em> (widget or page), not <em>where they can be used</em>. Both 
        can be returned from page controllers and widget controllers. The <code>targetContainer</code> determines 
        where the result appears.</p>

    <h5>WidgetResponse vs PageResponse Properties</h5>
    <p><strong>WidgetResponse</strong> properties:</p>
    <ul>
        <li><code>widgetClass</code> or <code>widgetId</code> - The widget to load</li>
        <li><code>targetContainer</code> - Which container to update</li>
        <li><code>parameters</code> - Widget parameters via <code>addParameter()</code></li>
    </ul>
    <p><strong>PageResponse</strong> properties:</p>
    <ul>
        <li><code>pageClass</code> - The page to navigate to</li>
        <li><code>parameters</code> - Page URL parameters via <code>addParameter()</code></li>
    </ul>
    <p>Note that <code>PageResponse</code> does not have <code>targetContainer</code> - pages are full-page 
        navigations.</p>

    <h5>Complex Navigation Example</h5>
    <pre><code class="language-java">@Widget
class ProductActionWidget {
    
    // Stay on current widget
    @Action("addToWishlist")
    void addToWishlist(@ActionParameter("productId") String productId) {
        wishlistService.add(productId);
    }
    
    // Navigate to details widget in same container
    @Action("viewDetails")
    WidgetResponse showDetails(@ActionParameter("productId") String productId) {
        return new WidgetResponse(ProductDetailsWidget.class)
            .addParameter("productId", productId);
    }
    
    // Navigate to details widget in different container
    @Action("viewInSidebar")
    WidgetResponse showInSidebar(@ActionParameter("productId") String productId) {
        return new WidgetResponse(ProductDetailsWidget.class)
            .targetContainer("sidebar")
            .addParameter("productId", productId);
    }
    
    // Navigate to full page
    @Action("viewFullPage")
    Class&lt;?&gt; showFullPage() {
        return ProductDetailsPage.class;
    }
    
    // Load remote widget by ID
    @Action("loadRecommendations")
    String loadRecommendations() {
        return "RecommendationsWidget"; // From recommendation microservice
    }
}</code></pre>

</xis:template>
